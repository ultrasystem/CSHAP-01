***************
*** 71,79 ****
  }
  
  static __inline__ int scm_send(struct socket *sock, struct msghdr *msg,
- 			       struct scm_cookie *scm)
  {
  	memset(scm, 0, sizeof(*scm));
  	unix_get_peersec_dgram(sock, scm);
  	if (msg->msg_controllen <= 0)
  		return 0;
--- 70,80 ----
  }
  
  static __inline__ int scm_send(struct socket *sock, struct msghdr *msg,
+ 			       struct scm_cookie *scm, bool forcecreds)
  {
  	memset(scm, 0, sizeof(*scm));
+ 	if (forcecreds)
+ 		scm_set_cred(scm, task_tgid(current), current_cred());
  	unix_get_peersec_dgram(sock, scm);
  	if (msg->msg_controllen <= 0)
  		return 0;
